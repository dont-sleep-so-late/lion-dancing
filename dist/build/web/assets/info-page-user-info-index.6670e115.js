import{b as e,Z as t,d as a,i as n,at as l,l as o,u as r,a as u,t as i,c as s,r as c,w as d,n as m,m as h,au as v,a1 as f,af as p,s as y,v as $,B as k,z as g,y as M,C as x,A as S,D as C,K as _,F as D,I as b,J as w,E as P,x as T,M as I,G as V,U as O,H as U,av as Y,aw as B,_ as j,ax as H,T as N,N as E,a4 as A,O as K}from"./index-a52e8601.js";import{T as W}from"./popup.e6bb817e.js";import{U as z,C as L}from"./event.66482612.js";import{i as F}from"./is-number.699c11c1.js";import{c as J}from"./clone-deep.2124c060.js";const Z=e({showCancel:{type:Boolean,default:!0},cancelText:{type:String,default:"取 消"},cancelColor:String,showConfirm:{type:Boolean,default:!0},confirmText:{type:String,default:"确 定"},confirmColor:String,mask:Boolean,zIndex:{type:Number,default:t.popup}}),R=e({...Z,modelValue:{type:a([String,Number,Array]),default:""},open:Boolean,data:{type:a([Array]),default:()=>[]},labelKey:{type:String,default:"label"},valueKey:{type:String,default:"value"},childrenKey:{type:String,default:"children"}}),q=e=>{const{emit:t}=h(),a=c(!1),n=c(!0);d((()=>e.open),(e=>{a.value=e}));const o=()=>{t("update:open",!1)};let r="signle";const u=t=>f(t)?{label:t[e.labelKey],value:t[e.valueKey],originalData:t}:{label:t,value:t,originalData:t},i=(t,a=1,n=[])=>{s.value.length<a&&s.value.push(...Array.from({length:a-s.value.length},(()=>[]))),s.value[a-1]=[...t.map((e=>u(e)))];let l=0;n.length&&(l=s.value[a-1].findIndex((e=>e.value===n[a-1])),l=~l?l:0),t[l]&&Object.prototype.hasOwnProperty.call(t[l],e.childrenKey)&&i(t[l][e.childrenKey],a+1,n)},s=c([]),y=c([]),$=()=>{let t=[];t=void 0===e.modelValue||l(e.modelValue)&&!e.modelValue.length?Array.from({length:s.value.length},(()=>0)):l(e.modelValue)?s.value.map(((t,a)=>{let n=0;return n=e.modelValue[a]?t.findIndex((t=>t.value===e.modelValue[a])):0,~n?n:0})):[s.value[0].findIndex((t=>t.value===e.modelValue))],y.value=t};d((()=>e.data),(()=>{(()=>{const{data:t}=e;t&&(l(t)||v("TnPicker","picker选择器数据不正确，请传递数组格式的数据"),0!==t.length&&(l(t[0])?(r="multiple",s.value=t.reduce(((e,t)=>(e.push(t.map((e=>u(e)))),e)),[])):!l(t[0])&&f(t[0])&&Object.prototype.hasOwnProperty.call(t[0],e.childrenKey)?(r="cascade",i(t,1,e.modelValue)):(r="signle",s.value=[t.map((e=>u(e)))]),m((()=>{$()}))))})()}),{immediate:!0});const k=()=>{if("signle"!==r||l(e.data[0])){const e=J(y.value);return e.splice(s.value.length),e.map(((e,t)=>{var a;return p(null==(a=s.value[t][e])?void 0:a.value,0)}))}return s.value[0][y.value[0]].value},g=()=>{if("signle"!==r||l(e.data[0])){const e=J(y.value);return e.splice(s.value.length),e.map(((e,t)=>{var a;return p(null==(a=s.value[t][e])?void 0:a.originalData,void 0)}))}return s.value[0][y.value[0]].originalData},M=t=>{"cascade"===r&&i(e.data,1,t),m((()=>{$()}))};let x=!1;d((()=>e.modelValue),(e=>{x?x=!1:M(e)}),{deep:!0});let S=null,C=!1;return{openPopup:a,showPicker:n,pickerData:s,currentPickerIndex:y,closePopupEvent:()=>{o(),M(e.modelValue),t("close")},pickerViewChangeEvent:a=>{if(C)return;S=setTimeout((()=>{C=!1,S&&clearTimeout(S),S=null}),300),C=!0;let n=y.value.findIndex(((e,t)=>e!==a.detail.value[t]));if(n=~n?n:0,y.value=a.detail.value,"cascade"===r){let t=e.data;for(let l=0;l<n;l++)t=t[y.value[l]][e.childrenKey];const a=y.value[n];s.value.splice(n+1),t[a]&&Object.prototype.hasOwnProperty.call(t[a],e.childrenKey)&&(i(t[a][e.childrenKey],n+2),y.value=s.value.map(((e,t)=>t<=n?y.value[t]:0)))}x=!0;const l=k(),o=g();t(L,l,n,o)},confirmEvent:()=>{const e=k(),a=g();x=!0,t(z,e),m((()=>{t("confirm",e,a)})),o()},cancelEvent:()=>{M(e.modelValue),t("cancel"),o()},initDefaultPickerIndex:$,resetPickerIndexWithPosition:(e,t)=>{y.value=y.value.map(((a,n)=>n>=e&&(!t||n<=t)?0:a))}}},G=j(y({__name:"picker",props:R,emits:{[z]:e=>n(e)||F(e)||l(e),"update:open":e=>o(e),[L]:(e,t,a)=>!0,confirm:(e,t)=>!0,cancel:()=>!0,close:()=>!0},setup(e,{expose:t}){const a=e,{openPopup:n,showPicker:l,pickerData:o,currentPickerIndex:c,closePopupEvent:d,pickerViewChangeEvent:m,confirmEvent:h,cancelEvent:v,initDefaultPickerIndex:f,resetPickerIndexWithPosition:p}=q(a),{ns:y,overlayOpacity:j,operationBtnClass:H,operationBtnStyle:N}=(e=>{const t=r("picker"),[a,n]=u(i(e,"cancelColor"),"text"),[l,o]=u(i(e,"confirmColor"),"text"),c=s((()=>e.mask?.5:0)),d=s((()=>e=>{const n=[t.e("operation-btn"),t.em("operation-btn",e)];return"cancel"===e?a.value&&n.push(a.value):"confirm"===e&&l.value&&n.push(l.value),n.join(" ")})),m=s((()=>e=>{const t={};return"cancel"===e?a.value||(t.color=n.value||"var(--tn-color-danger)"):"confirm"===e&&(l.value||(t.color=o.value||"var(--tn-color-primary)")),t}));return{ns:t,overlayOpacity:c,operationBtnClass:d,operationBtnStyle:m}})(a);return t({resetPickerViewIndex:()=>{f()},resetPickerIndexWithPosition:p}),(e,t)=>{const r=U,u=B,i=Y;return $(),k(W,{modelValue:S(n),"onUpdate:modelValue":t[0]||(t[0]=e=>O(n)?n.value=e:null),"open-direction":"bottom",overlay:!0,"overlay-opacity":S(j),radius:0,"safe-area-inset-bottom":!1,"z-index":e.zIndex,onClose:S(d)},{default:g((()=>[M(r,{class:x(["tn-u-safe-area",[S(y).b()]])},{default:g((()=>[M(r,{class:x([S(y).e("operation"),S(y).is("only-confirm",!e.showCancel)])},{default:g((()=>[e.showCancel?($(),k(r,{key:0,class:x([S(H)("cancel")]),style:C(S(N)("cancel")),onClick:_(S(v),["stop"])},{default:g((()=>[D(e.$slots,"cancel",{},(()=>[b(w(a.cancelText),1)]),!0)])),_:3},8,["class","style","onClick"])):P("",!0),M(r,{class:x([S(H)("confirm")]),style:C(S(N)("confirm")),onClick:_(S(h),["stop"])},{default:g((()=>[D(e.$slots,"confirm",{},(()=>[b(w(a.confirmText),1)]),!0)])),_:3},8,["class","style","onClick"])])),_:3},8,["class"]),M(r,{class:x([S(y).e("content")])},{default:g((()=>[S(l)?($(),k(i,{key:0,class:x([S(y).e("picker-view")]),value:S(c),onChange:S(m)},{default:g((()=>[($(!0),T(V,null,I(S(o),((e,t)=>($(),k(u,{key:t,class:x([S(y).e("picker-view-column")])},{default:g((()=>[($(!0),T(V,null,I(e,((e,t)=>($(),k(r,{key:t,class:x(S(y).e("content-item"))},{default:g((()=>[M(r,{class:x(["tn-text-ellipsis-1",S(y).em("content-item","data")])},{default:g((()=>[b(w(e.label),1)])),_:2},1032,["class"])])),_:2},1032,["class"])))),128))])),_:2},1032,["class"])))),128))])),_:1},8,["class","value","onChange"])):P("",!0)])),_:1},8,["class"])])),_:3},8,["class"])])),_:3},8,["modelValue","overlay-opacity","z-index","onClose"])}}}),[["__scopeId","data-v-4c4f040c"]]),Q=e({...Z,modelValue:{type:String,default:""},open:Boolean,mode:{type:String,values:["year","yearmonth","date","datetime","time"],default:"date"},minTime:String,maxTime:String,initCurrentDateTime:{type:Boolean,default:!0},format:String}),X={[z]:e=>n(e),[L]:e=>n(e),"update:open":e=>o(e),confirm:e=>n(e),cancel:()=>!0,close:()=>!0};var ee=1e3,te=6e4,ae=36e5,ne="millisecond",le="second",oe="minute",re="hour",ue="day",ie="week",se="month",ce="quarter",de="year",me="date",he="Invalid Date",ve=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,fe=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;const pe={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||t[0])+"]"}};var ye=function(e,t,a){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(a)+e};const $e={s:ye,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),n=Math.floor(a/60),l=a%60;return(t<=0?"+":"-")+ye(n,2,"0")+":"+ye(l,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var n=12*(a.year()-t.year())+(a.month()-t.month()),l=t.clone().add(n,se),o=a-l<0,r=t.clone().add(n+(o?-1:1),se);return+(-(n+(a-l)/(o?l-r:r-l))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:se,y:de,w:ie,d:ue,D:me,h:re,m:oe,s:le,ms:ne,Q:ce}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};var ke="en",ge={};ge[ke]=pe;var Me=function(e){return e instanceof _e},xe=function e(t,a,n){var l;if(!t)return ke;if("string"==typeof t){var o=t.toLowerCase();ge[o]&&(l=o),a&&(ge[o]=a,l=o);var r=t.split("-");if(!l&&r.length>1)return e(r[0])}else{var u=t.name;ge[u]=t,l=u}return!n&&l&&(ke=l),l||!n&&ke},Se=function(e,t){if(Me(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new _e(a)},Ce=$e;Ce.l=xe,Ce.i=Me,Ce.w=function(e,t){return Se(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var _e=function(){function e(e){this.$L=xe(e.locale,null,!0),this.parse(e)}var t=e.prototype;return t.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(Ce.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(ve);if(n){var l=n[2]-1||0,o=(n[7]||"0").substring(0,3);return a?new Date(Date.UTC(n[1],l,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],l,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return Ce},t.isValid=function(){return!(this.$d.toString()===he)},t.isSame=function(e,t){var a=Se(e);return this.startOf(t)<=a&&a<=this.endOf(t)},t.isAfter=function(e,t){return Se(e)<this.startOf(t)},t.isBefore=function(e,t){return this.endOf(t)<Se(e)},t.$g=function(e,t,a){return Ce.u(e)?this[t]:this.set(a,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,t){var a=this,n=!!Ce.u(t)||t,l=Ce.p(e),o=function(e,t){var l=Ce.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return n?l:l.endOf(ue)},r=function(e,t){return Ce.w(a.toDate()[e].apply(a.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},u=this.$W,i=this.$M,s=this.$D,c="set"+(this.$u?"UTC":"");switch(l){case de:return n?o(1,0):o(31,11);case se:return n?o(1,i):o(0,i+1);case ie:var d=this.$locale().weekStart||0,m=(u<d?u+7:u)-d;return o(n?s-m:s+(6-m),i);case ue:case me:return r(c+"Hours",0);case re:return r(c+"Minutes",1);case oe:return r(c+"Seconds",2);case le:return r(c+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,t){var a,n=Ce.p(e),l="set"+(this.$u?"UTC":""),o=(a={},a[ue]=l+"Date",a[me]=l+"Date",a[se]=l+"Month",a[de]=l+"FullYear",a[re]=l+"Hours",a[oe]=l+"Minutes",a[le]=l+"Seconds",a[ne]=l+"Milliseconds",a)[n],r=n===ue?this.$D+(t-this.$W):t;if(n===se||n===de){var u=this.clone().set(me,1);u.$d[o](r),u.init(),this.$d=u.set(me,Math.min(this.$D,u.daysInMonth())).$d}else o&&this.$d[o](r);return this.init(),this},t.set=function(e,t){return this.clone().$set(e,t)},t.get=function(e){return this[Ce.p(e)]()},t.add=function(e,t){var a,n=this;e=Number(e);var l=Ce.p(t),o=function(t){var a=Se(n);return Ce.w(a.date(a.date()+Math.round(t*e)),n)};if(l===se)return this.set(se,this.$M+e);if(l===de)return this.set(de,this.$y+e);if(l===ue)return o(1);if(l===ie)return o(7);var r=(a={},a[oe]=te,a[re]=ae,a[le]=ee,a)[l]||1,u=this.$d.getTime()+e*r;return Ce.w(u,this)},t.subtract=function(e,t){return this.add(-1*e,t)},t.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||he;var n=e||"YYYY-MM-DDTHH:mm:ssZ",l=Ce.z(this),o=this.$H,r=this.$m,u=this.$M,i=a.weekdays,s=a.months,c=function(e,a,l,o){return e&&(e[a]||e(t,n))||l[a].slice(0,o)},d=function(e){return Ce.s(o%12||12,e,"0")},m=a.meridiem||function(e,t,a){var n=e<12?"AM":"PM";return a?n.toLowerCase():n},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:Ce.s(u+1,2,"0"),MMM:c(a.monthsShort,u,s,3),MMMM:c(s,u),D:this.$D,DD:Ce.s(this.$D,2,"0"),d:String(this.$W),dd:c(a.weekdaysMin,this.$W,i,2),ddd:c(a.weekdaysShort,this.$W,i,3),dddd:i[this.$W],H:String(o),HH:Ce.s(o,2,"0"),h:d(1),hh:d(2),a:m(o,r,!0),A:m(o,r,!1),m:String(r),mm:Ce.s(r,2,"0"),s:String(this.$s),ss:Ce.s(this.$s,2,"0"),SSS:Ce.s(this.$ms,3,"0"),Z:l};return n.replace(fe,(function(e,t){return t||h[e]||l.replace(":","")}))},t.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},t.diff=function(e,t,a){var n,l=Ce.p(t),o=Se(e),r=(o.utcOffset()-this.utcOffset())*te,u=this-o,i=Ce.m(this,o);return i=(n={},n[de]=i/12,n[se]=i,n[ce]=i/3,n[ie]=(u-r)/6048e5,n[ue]=(u-r)/864e5,n[re]=u/ae,n[oe]=u/te,n[le]=u/ee,n)[l]||u,a?i:Ce.a(i)},t.daysInMonth=function(){return this.endOf(se).$D},t.$locale=function(){return ge[this.$L]},t.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),n=xe(e,t,!0);return n&&(a.$L=n),a},t.clone=function(){return Ce.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},e}(),De=_e.prototype;Se.prototype=De,[["$ms",ne],["$s",le],["$m",oe],["$H",re],["$W",ue],["$M",se],["$y",de],["$D",me]].forEach((function(e){De[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),Se.extend=function(e,t){return e.$i||(e(t,_e,Se),e.$i=!0),Se},Se.locale=xe,Se.isDayjs=Me,Se.unix=function(e){return Se(1e3*e)},Se.en=ge[ke],Se.Ls=ge,Se.p={};const be="YYYY/MM/DD HH:mm:ss",we=Se(),Pe=(e,t)=>(t=t<e?e:t,Array.from({length:t-e+1}).map(((t,a)=>e+a))),Te=(e,t,a)=>Math.min(Math.max(e,a),t),Ie=e=>{const{emit:t}=h(),{pickerData:a,minTimeDayjs:n,maxTimeDayjs:l,generatePickerData:o,fillDateTime:r}=(e=>{const t=c([]),a=c([]),n=c([]),l=c([]),o=c([]),r=c([]),u=(t,a)=>{a||(a=be);let n="";if("time"===e.mode){const e=/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2}))?$/;n=t.replace(e,((e,t,a,n)=>`1970/01/01 ${t}:${a||"00"}:${n||"00"}`))}else{const e=/^(\d{4})(?:[-/](\d{1,2}))?(?:[-/](\d{1,2}))?(?:\s?(\d{1,2}))?(?::(\d{1,2}))?(?::(\d{1,2}))?$/;n=(t=Se(t,a).format(be)).replace(e,((e,t,a,n,l,o,r)=>`${t}/${a||"01"}/${n||"01"} ${l||"00"}:${o||"00"}:${r||"00"}`))}return Se(n,a)},i=s((()=>{let t=we.year()-10+"/01/01 00:00:00";return e.minTime&&(t=e.minTime),u(t)})),d=s((()=>{let t=`${we.year()+10}/12/31 23:59:59`;return e.maxTime&&(t=e.maxTime),u(t)}));return{pickerData:s((()=>{const u=[];return"year"===e.mode&&u.push(t.value),"yearmonth"===e.mode&&u.push(t.value,a.value),"date"===e.mode&&u.push(t.value,a.value,n.value),"time"===e.mode&&u.push(l.value,o.value,r.value),"datetime"===e.mode&&u.push(t.value,a.value,n.value,l.value,o.value,r.value),u})),minTimeDayjs:i,maxTimeDayjs:d,generatePickerData:u=>{const s=u.year()===i.value.year(),c=u.year()===d.value.year(),m=u.month()===i.value.month(),h=u.month()===d.value.month(),v=u.date()===i.value.date(),f=u.date()===d.value.date(),p=u.hour()===i.value.hour(),y=u.hour()===d.value.hour(),$=u.minute()===i.value.minute(),k=u.minute()===d.value.minute(),g=i.value.year(),M=d.value.year(),x=s?i.value.month()+1:1,S=c?d.value.month()+1:12,C=s&&m?i.value.date():1,_=c&&h?d.value.date():u.daysInMonth(),D=s&&m&&v||"time"===e.mode?i.value.hour():0,b=c&&h&&f||"time"===e.mode?d.value.hour():23,w=(s&&m&&v||"time"===e.mode)&&p?i.value.minute():0,P=(c&&h&&f||"time"===e.mode)&&y?d.value.minute():59,T=(s&&m&&v||"time"===e.mode)&&p&&$?i.value.second():0,I=(c&&h&&f||"time"===e.mode)&&y&&k?d.value.second():59;t.value=Pe(g,M).map((e=>({label:`${e}年`,value:e}))),a.value=Pe(x,S).map((e=>({label:`${String(e).padStart(2,"0")}月`,value:e}))),n.value=Pe(C,_).map((e=>({label:`${String(e).padStart(2,"0")}日`,value:e}))),l.value=Pe(D,b).map((e=>({label:String(e).padStart(2,"0"),value:e}))),o.value=Pe(w,P).map((e=>({label:String(e).padStart(2,"0"),value:e}))),r.value=Pe(T,I).map((e=>({label:String(e).padStart(2,"0"),value:e})))},fillDateTime:u,getTimeMaxMinValue:(e,t,a)=>{const n={...a};let l=0,o=0,r=0,u=0,i=0,s=0,c=0,d=0,m=0,h=0,v=0;return"[object Object]"===e.toString()?({year:l,month:o,date:r,hour:u,minute:i}=e):(l=e.year(),o=e.month(),r=e.date(),u=e.hour(),i=e.minute()),"[object Object]"===t.toString()?({year:s,month:c,date:d,hour:m,minute:h,second:v}=t):(s=t.year(),c=t.month(),d=t.date(),m=t.hour(),h=t.minute(),v=t.second()),l===s&&(n.month=c,o===c&&(n.date=d,r===d&&(n.hour=m,u===m&&(n.minute=h,i===h&&(n.second=v))))),n}}})(e),{handlePickerChangeMinMaxTime:u}=((e,t)=>{const a=a=>(a.year()===e.value.year()&&(a=a.set("month",Math.max(e.value.month(),a.month()))),a.year()===t.value.year()&&(a=a.set("month",Math.min(t.value.month(),a.month()))),a),n=a=>(a.year()===e.value.year()&&(a=a.set("month",Math.max(e.value.month(),a.month()))).month()===e.value.month()&&(a=a.set("date",Math.max(e.value.date(),a.date()))),a.year()===t.value.year()&&(a=a.set("month",Math.min(t.value.month(),a.month()))).month()===t.value.month()&&(a=a.set("date",Math.min(t.value.date(),a.date()))),a),l=a=>(a.year()===e.value.year()&&(a=a.set("month",Math.max(e.value.month(),a.month()))).month()===e.value.month()&&(a=a.set("date",Math.max(e.value.date(),a.date()))).date()===e.value.date()&&(a=a.set("hour",Math.max(e.value.hour(),a.hour()))).hour()===e.value.hour()&&(a=a.set("minute",Math.max(e.value.minute(),a.minute()))).minute()===e.value.minute()&&(a=a.set("second",Math.max(e.value.second(),a.second()))),a.year()===t.value.year()&&(a=a.set("month",Math.min(t.value.month(),a.month()))).month()===t.value.month()&&(a=a.set("date",Math.min(t.value.date(),a.date()))).date()===t.value.date()&&(a=a.set("hour",Math.min(t.value.hour(),a.hour()))).hour()===t.value.hour()&&(a=a.set("minute",Math.min(t.value.minute(),a.minute()))).minute()===t.value.minute()&&(a=a.set("second",Math.min(t.value.second(),a.second()))),a),o=a=>(a.hour()===e.value.hour()&&(a=a.set("minute",Math.max(e.value.minute(),a.minute()))).minute()===e.value.minute()&&(a=a.set("second",Math.max(e.value.second(),a.second()))),a.hour()===t.value.hour()&&(a=a.set("minute",Math.min(t.value.minute(),a.minute()))).minute()===t.value.minute()&&(a=a.set("second",Math.min(t.value.second(),a.second()))),a);return{handlePickerChangeMinMaxTime:(e,t)=>{switch(e){case"yearmonth":return a(t);case"date":return n(t);case"datetime":return l(t);case"time":return o(t);default:return t}}}})(n,l),i=c(),v=c(!1);d((()=>e.open),(e=>{v.value=e}));const f=()=>{t("update:open",!1)};d((()=>[e.minTime,e.maxTime,e.modelValue]),(()=>{$(!1)}));const p=c([]),y=t=>{const a=t.year(),n=String(t.month()+1).padStart(2,"0"),l=String(t.date()).padStart(2,"0"),o=String(t.hour()).padStart(2,"0"),r=String(t.minute()).padStart(2,"0"),u=String(t.second()).padStart(2,"0");return"year"===e.mode?`${a}`:"yearmonth"===e.mode?Se(`${a}/${n}`).format(e.format||"YYYY/MM"):"date"===e.mode?Se(`${a}/${n}/${l}`).format(e.format||"YYYY/MM/DD"):"time"===e.mode?`${o}:${r}:${u}`:Se(`${a}/${n}/${l} ${o}:${r}:${u}`).format(e.format||be)},$=(a=!0)=>{let u=Se();e.modelValue&&(u=r(e.modelValue,e.format)),"time"!==e.mode?(u=u.year(Te(n.value.year(),l.value.year(),u.year())),u.year()===n.value.year()&&(u.month()<n.value.month()?u=u.month(n.value.month()).date(n.value.date()).hour(n.value.hour()).minute(n.value.minute()).second(n.value.second()):u.month()>l.value.month()?u=u.month(l.value.month()).date(1).hour(0).minute(0).second(0):u.date()<n.value.date()?u=u.date(n.value.date()).hour(n.value.hour()).minute(n.value.minute()):u.date()>l.value.date()&&(u=u.date(l.value.date()).hour(l.value.hour()).minute(l.value.minute())))):(u=u.hour(Te(n.value.hour(),l.value.hour(),u.hour())),u.hour()===n.value.hour()&&(u=u.minute(Math.max(n.value.minute(),u.minute())),u.minute()===n.value.minute()&&(u=u.second(Math.max(n.value.second(),u.second())))),u.hour()===l.value.hour()&&(u=u.minute(Math.min(l.value.minute(),u.minute())),u.minute()===l.value.minute()&&(u=u.second(0)))),o(u),(t=>{const a=t.year(),n=t.month()+1,l=t.date(),o=t.hour(),r=t.minute(),u=t.second();"year"===e.mode&&(p.value=[a]),"yearmonth"===e.mode&&(p.value=[a,n]),"date"===e.mode&&(p.value=[a,n,l]),"time"===e.mode&&(p.value=[o,r,u]),"datetime"===e.mode&&(p.value=[a,n,l,o,r,u])})(u),a&&t(z,y(u))},k=t=>{let a="";if("year"===e.mode&&(a=`${t[0]}`),"yearmonth"===e.mode&&(a=`${t[0]}/${t[1]}`),"date"===e.mode){const e=Number(t[0]),n=Number(t[1]),l=Math.min(Se().year(e).month(n-1).daysInMonth(),Number(t[2]));a=`${t[0]}/${n}/${l}`}if("time"===e.mode&&(a=`${t[0]}:${t[1]}:${t[2]}`),"datetime"===e.mode){const e=Number(t[0]),n=Number(t[1]),l=Math.min(Se().year(e).month(n-1).daysInMonth(),Number(t[2]));a=`${t[0]}/${n}/${l} ${t[3]}:${t[4]}:${t[5]}`}return r(a)};return{pickerRef:i,showPicker:v,pickerData:a,pickerSelectData:p,handlePickerCloseEvent:()=>{f(),$(!1),t("close")},initDateTimePicker:$,pickerValueChangeEvent:a=>{let n=k(a);n=u(e.mode,n),"year"===e.mode&&(p.value=[n.year()]),"yearmonth"===e.mode&&(p.value=[n.year(),n.month()+1]),"date"===e.mode&&(p.value=[n.year(),n.month()+1,n.date()]),"time"===e.mode&&(p.value=[n.hour(),n.minute(),n.second()]),"datetime"===e.mode&&(p.value=[n.year(),n.month()+1,n.date(),n.hour(),n.minute(),n.second()]),m((()=>{o(n)}));const l=y(n);t(L,l)},handlePickerConfirmEvent:e=>{const a=k(e),n=y(a);t(z,n),m((()=>{t("confirm",n)})),f()},handlePickerCancelEvent:()=>{$(!1),t("cancel"),f()}}},Ve=y({__name:"date-time-picker",props:Q,emits:X,setup(e){const t=e,{pickerRef:a,showPicker:n,pickerData:l,pickerSelectData:o,handlePickerCloseEvent:r,initDateTimePicker:u,pickerValueChangeEvent:i,handlePickerConfirmEvent:s,handlePickerCancelEvent:c}=Ie(t);return u(t.initCurrentDateTime),(e,t)=>($(),k(G,{ref_key:"pickerRef",ref:a,open:S(n),"onUpdate:open":t[0]||(t[0]=e=>O(n)?n.value=e:null),"model-value":S(o),data:S(l),"show-cancel":e.showCancel,"show-confirm":e.showConfirm,mask:e.mask,"cancel-text":e.cancelText,"cancel-color":e.cancelColor,"confirm-text":e.confirmText,"confirm-color":e.confirmColor,"z-index":e.zIndex,onChange:S(i),onConfirm:S(s),onCancel:S(c),onClose:S(r)},null,8,["open","model-value","data","show-cancel","show-confirm","mask","cancel-text","cancel-color","confirm-text","confirm-color","z-index","onChange","onConfirm","onCancel","onClose"]))}}),Oe=e({show:{type:Boolean,default:!1},avatar:{type:String,default:""},nickname:{type:String,default:""},title:{type:String,default:"获取您的昵称、头像"},tips:{type:String,default:"获取用户头像、昵称，主要用于向用户提供具有辨识度的用户体验"},confirmText:{type:String,default:"保 存"},confirmBgColor:{type:String,default:"tn-type-primary"},confirmTextColor:{type:String,default:"tn-white"}}),Ue=j(y({__name:"index",props:Oe,emits:{"update:show":e=>o(e),"update:avatar":e=>n(e),"update:nickname":e=>n(e),confirm:(e,t)=>!0,"choose-avatar":e=>n(e)},setup(e,{emit:t}){const a=e,{showUpdatePopup:n,inputNickname:l,popupCloseHandle:o,nickNameInputHandle:m,submitBtnClickHandle:h,avatarClickHandle:v}=((e,t)=>{const a=c(!1),n=c(e.nickname);return d((()=>e.show),(e=>{a.value=e}),{immediate:!0}),{showUpdatePopup:a,inputNickname:n,nickNameInputHandle:e=>{const a=e.detail.value;n.value=a,t("update:nickname",a)},popupCloseHandle:()=>{t("update:show",!1)},submitBtnClickHandle:()=>{n.value&&e.avatar&&(t("confirm",e.avatar,n.value),t("update:show",!1))},avatarClickHandle:()=>{H({count:1,success:e=>{t("choose-avatar",e.tempFilePaths[0])}})}}})(a,t),{ns:f,submitBtnClass:p,submitBtnStyle:y}=(e=>{const t=r("update-user-info-popup"),[a,n]=u(i(e,"confirmBgColor"),"bg"),[l,o]=u(i(e,"confirmTextColor"),"text"),c=s((()=>{const e=[t.e("submit-btn")];return a.value&&e.push(a.value),l.value&&e.push(l.value),e.join(" ")})),d=s((()=>{const t={};return a.value||(t.backgroundColor=n.value||"var(--tn-color-primary)"),o.value?t.color=o.value:a.value||(t.color="var(--tn-color-white)"),e.avatar&&e.nickname||(t.backgroundColor="var(--tn-color-gray-disabled)",t.color="var(--tn-color-gray-dark)"),t}));return{ns:t,submitBtnClass:c,submitBtnStyle:d}})(a);return(e,t)=>{const a=U,r=E,u=A;return $(),k(W,{modelValue:S(n),"onUpdate:modelValue":t[0]||(t[0]=e=>O(n)?n.value=e:null),"open-direction":"bottom","close-btn":"","safe-area-inset-bottom":!1,onClose:S(o)},{default:g((()=>[M(a,{class:x([S(f).b()])},{default:g((()=>[M(a,{class:x([S(f).e("title")])},{default:g((()=>[b(w(e.title),1)])),_:1},8,["class"]),M(a,{class:x([S(f).e("tips")])},{default:g((()=>[b(w(e.tips),1)])),_:1},8,["class"]),M(a,{class:x([S(f).e("avatar")])},{default:g((()=>[M(a,{class:x([S(f).em("avatar","container")]),onClick:_(S(v),["stop"])},{default:g((()=>[e.avatar?($(),k(r,{key:0,class:x([S(f).em("avatar","image")]),src:e.avatar,mode:"aspectFill"},null,8,["class","src"])):($(),k(a,{key:1,class:x([S(f).em("avatar","empty")])},{default:g((()=>[M(N,{name:"clover-fill"})])),_:1},8,["class"])),M(a,{class:x([S(f).em("avatar","assist")])},{default:g((()=>[M(N,{name:"camera-fill"})])),_:1},8,["class"])])),_:1},8,["class","onClick"])])),_:1},8,["class"]),M(u,{class:x([S(f).e("nickname-input")]),value:S(l),type:"nickname",placeholder:"请输入昵称","placeholder-style":"color:var(--tn-color-gray);",onInput:S(m)},null,8,["class","value","onInput"]),M(a,{class:x([S(p)]),style:C(S(y)),onClick:_(S(h),["stop"])},{default:g((()=>[b(w(e.confirmText),1)])),_:1},8,["class","style","onClick"])])),_:1},8,["class"])])),_:1},8,["modelValue","onClose"])}}}),[["__scopeId","data-v-5f543b75"]]),Ye={0:"保密",1:"男",2:"女"},Be=j(y({__name:"index",setup(e){const{userInfo:t,showUpdateUserInfoPopup:a,showSexPicker:n,showBirthdayPicker:l,showProfessionPicker:o,sexPickerData:r,professionPickerData:u,openUpdateUserInfoPopup:i,openSexPicker:s,openBirthdayPicker:d,openProfessionPicker:m}=(()=>{const e=c({uid:"1",nickname:"你别睡这么晚",username:"",avatar:"https://resource.tuniaokj.com/images/avatar/xiong.jpg",phone:"18888888888",sex:2,desc:"静下心来，做好狮业有承",birthday:"1995-06-01",profession:"前端开发"}),t=c(!1),a=c(!1),n=c(!1),l=c(!1);return{userInfo:e,showUpdateUserInfoPopup:t,showSexPicker:a,showBirthdayPicker:n,showProfessionPicker:l,sexPickerData:[{label:"男",value:1},{label:"女",value:2},{label:"保密",value:0}],professionPickerData:["前端开发","后端开发","产品经理","UI设计师","运营"],openUpdateUserInfoPopup:()=>{t.value=!0},openSexPicker:()=>{a.value=!0},openBirthdayPicker:()=>{n.value=!0},openProfessionPicker:()=>{l.value=!0}}})();return(e,c)=>{const h=K("TnNavbar"),v=U,f=A,p=E,y=K("TnIcon");return $(),T(V,null,[M(h,{fixed:"","bottom-shadow":!1}),M(v,{class:"user-info"},{default:g((()=>[M(v,{class:"avatar-nickname"},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"nickname",onClick:_(S(i),["stop"])},{default:g((()=>[b(w(S(t).nickname),1)])),_:1},8,["onClick"]),M(v,{class:"desc"},{default:g((()=>[M(f,{class:"input",value:S(t).desc,placeholder:"请输入描述","placeholder-style":"color: var(--tn-color-gray-disabled)"},null,8,["value"])])),_:1})])),_:1}),M(v,{class:"avatar",onClick:_(S(i),["stop"])},{default:g((()=>[M(p,{class:"tn-image",src:S(t).avatar,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])])),_:1}),M(v,{class:"info-item"},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"item-title"},{default:g((()=>[b("绑定手机号")])),_:1}),M(v,{class:"content"},{default:g((()=>[b(w(S(t).phone||"未绑定"),1)])),_:1})])),_:1}),M(v,{class:"right"},{default:g((()=>[M(y,{name:"right"})])),_:1})])),_:1}),M(v,{class:"info-item"},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"item-title"},{default:g((()=>[b("姓名")])),_:1}),M(v,{class:"content"},{default:g((()=>[M(f,{class:"input",value:S(t).username,placeholder:"请输入姓名","placeholder-style":"color: var(--tn-color-gray-disabled)"},null,8,["value"])])),_:1})])),_:1})])),_:1}),M(v,{class:"info-item",onClick:_(S(s),["stop"])},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"item-title"},{default:g((()=>[b("性别")])),_:1}),M(v,{class:"content"},{default:g((()=>{var e;return[b(w((null==(e=S(Ye))?void 0:e[S(t).sex])||"请选择性别"),1)]})),_:1})])),_:1}),M(v,{class:"right"},{default:g((()=>[M(y,{name:"right"})])),_:1})])),_:1},8,["onClick"]),M(v,{class:"info-item",onClick:_(S(d),["stop"])},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"item-title"},{default:g((()=>[b("生日")])),_:1}),M(v,{class:"content"},{default:g((()=>[b(w(S(t).birthday||"请选择生日"),1)])),_:1})])),_:1}),M(v,{class:"right"},{default:g((()=>[M(y,{name:"right"})])),_:1})])),_:1},8,["onClick"]),M(v,{class:"info-item",onClick:_(S(m),["stop"])},{default:g((()=>[M(v,{class:"left"},{default:g((()=>[M(v,{class:"item-title"},{default:g((()=>[b("职业")])),_:1}),M(v,{class:"content"},{default:g((()=>[b(w(S(t).profession||"请选择职业"),1)])),_:1})])),_:1}),M(v,{class:"right"},{default:g((()=>[M(y,{name:"right"})])),_:1})])),_:1},8,["onClick"])])),_:1}),M(Ue,{show:S(a),"onUpdate:show":c[0]||(c[0]=e=>O(a)?a.value=e:null),avatar:S(t).avatar,"onUpdate:avatar":c[1]||(c[1]=e=>S(t).avatar=e),nickname:S(t).nickname,"onUpdate:nickname":c[2]||(c[2]=e=>S(t).nickname=e)},null,8,["show","avatar","nickname"]),M(G,{open:S(n),"onUpdate:open":c[3]||(c[3]=e=>O(n)?n.value=e:null),modelValue:S(t).sex,"onUpdate:modelValue":c[4]||(c[4]=e=>S(t).sex=e),data:S(r)},null,8,["open","modelValue","data"]),M(Ve,{open:S(l),"onUpdate:open":c[5]||(c[5]=e=>O(l)?l.value=e:null),modelValue:S(t).birthday,"onUpdate:modelValue":c[6]||(c[6]=e=>S(t).birthday=e),type:"date",format:"YYYY-MM-DD","min-time":"1900/01/01"},null,8,["open","modelValue"]),M(G,{open:S(o),"onUpdate:open":c[7]||(c[7]=e=>O(o)?o.value=e:null),modelValue:S(t).profession,"onUpdate:modelValue":c[8]||(c[8]=e=>S(t).profession=e),data:S(u)},null,8,["open","modelValue","data"])],64)}}}),[["__scopeId","data-v-58e9886b"]]);export{Be as default};
